---
import { documentToHtmlString } from "@contentful/rich-text-html-renderer";
import HomepageProject from "../components/HomepageProject.astro";
import Nav from "../components/Nav.astro";
import { getProjects } from "../utils/getProjects";
import { getPage } from "../utils/getPage";

const [projectCollection, homePage] = await Promise.all([
  getProjects(),
  getPage("29Er1TVqlv7ayMPQomKmYq"),
]);
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Robin Porter | ACD & Copywriter</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style is:global lang="scss">
      :root {
        --main-bg-color: #fff;
        --main-text-color: #334;
        --spacing-0: 0.25rem;
        --spacing-1: 0.5rem;
        --spacing-2: 1rem;
        --spacing-3: 2rem;
        --spacing-4: 3rem;
        --breakpoint-small: 640px;
      }

      @font-face {
        font-family: "Inter";
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: url("../../Inter-Regular.woff2?v=3.19") format("woff2"),
          url("../../Inter-Regular.woff?v=3.19") format("woff");
      }

      @font-face {
        font-family: "Inter";
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: url("../../Inter-Bold.woff2?v=3.19") format("woff2"),
          url("../../Inter-Bold.woff?v=3.19") format("woff");
      }

      html {
        font-family: "Inter", sans-serif;
        color: var(--main-text-color);
        background-color: var(--main-bg-color);
      }

      body {
        margin: 0;
        padding-top: 4rem;
      }
    </style>
    <style lang="scss">
      .project-wrapper {
        display: grid;
        grid-template-columns: 1fr;
        gap: var(--spacing-3);

        @media (min-width: 600px) {
          grid-template-columns: 1fr 1fr;
          padding: 0 var(--spacing-3);
        }

        @media (min-width: 1024px) {
          grid-template-columns: 1fr 1fr 1fr;
          gap: var(--spacing-4);
          padding: 0 var(--spacing-4);
        }
      }

      .about-wrapper {
        padding: 0 var(--spacing-2);
        max-width: 40em;

        @media (min-width: 600px) {
          font-size: 1.1rem;
          padding: 0 var(--spacing-3);
        }

        @media (min-width: 1024px) {
          font-size: 1.2rem;
          padding: 0 var(--spacing-4);
        }
      }

      .about-blurb {
        line-height: 1.5em;
        font-size: 1rem;

        @media (min-width: 600px) {
          font-size: 1.1rem;
        }

        @media (min-width: 1024px) {
          font-size: 1.2rem;
        }
      }

      .section-heading {
        text-transform: uppercase;
        font-size: 1rem;
        letter-spacing: 0.05em;
        padding-left: var(--spacing-2);
        padding-top: var(--spacing-4);

        @media (min-width: 600px) {
          font-size: 1.1rem;
          padding-left: var(--spacing-3);
        }

        @media (min-width: 1024px) {
          font-size: 1.2rem;
          padding-left: var(--spacing-4);
        }
      }
    </style>
  </head>
  <body>
    <Nav />
    <h2 id="about" class="section-heading">About</h2>
    <div class="about-wrapper">
      <div
        class="about-blurb"
        set:html={documentToHtmlString(homePage.fields.body)}
      >
      </div>
    </div>
    <h2 id="projects" class="section-heading">Projects</h2>
    <div class="project-wrapper">
      {
        projectCollection.items.map((project) => (
          <div class="project-item">
            <HomepageProject project={project} />
          </div>
        ))
      }
    </div>
  </body>
</html>
